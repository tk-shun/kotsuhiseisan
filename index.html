<!DOCTYPE html>
<html>
<head>
<!-- bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/floatthead/1.4.5/jquery.floatThead.js"></script>

<script type="text/javascript">
</script>
</head>
<body>

<div class="input-group">
  <span class="input-group-addon" id="basic-addon">年月</span>
  <input id="yymm" type="month" class="form-control">
</div>
<button class="btn btn-primary" onClick="test();">テスト</button>
<button class="btn btn-primary" onClick="createKotsuhiSeisan();">作成</button>
  <table id="event" class="table table-condensed table-bordered floatThead">
    <thead style="background:#cccccc;">
      <tr>
        <th>日付</th>
        <th>行先</th>
        <th>用件</th>
        <th>往復</th>
        <th colspan="3">経路1</th>
        <th colspan="2">経路2</th>
        <th colspan="2">経路3</th>
        <th colspan="2">経路4</th>
      </tr>
    </thead>
    <tbody id="eventDetail">
    </tbody>
  </table>
<script type="text/javascript">
$(function(){
//  $('.floatThead').floatThead();
  
  　　// 年月欄に当月を設定
  var date = new Date();
  var yyyy = date.getFullYear();
  var mm = ("0"+(date.getMonth()+1)).slice(-2);
  $('#yymm').val(yyyy+'-'+mm);
});


/* 作成処理実行 */
function createKotsuhiSeisan(){
　　var yymm = $('#yymm').val();
  google.script.run.withSuccessHandler(result).createEventsHtml(yymm);
  function result(html){
    $('#eventDetail').append(html);
　　}
}

</script>
</body>
</html>
